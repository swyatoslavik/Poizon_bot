from aiogram import types
from aiogram.types import CallbackQuery, MediaGroup, InputFile

from google_sheets import ORDERS
from handlers.users.menu import menu
from keyboards.default import kb_return
from keyboards.inline import ikb_menu
from loader import dp
from states.calculate_clothes import CalculateClothes
from states.calculate_shoes import CalculateShoes


@dp.message_handler(text="üí∞–†–∞—Å—Å—á–∏—Ç–∞—Ç—å –æ–±—É–≤—å")
async def command_calculate_shoes(message: types.Message):
    await message.answer("–£–∫–∞–∂–∏—Ç–µ —Å—Ç–æ–∏–º–æ—Å—Ç—å —Ç–æ–≤–∞—Ä–∞ –≤ —é–∞–Ω—è—Ö", reply_markup=kb_return)
    await CalculateShoes.price.set()


@dp.message_handler(text="üí∞–†–∞—Å—Å—á–∏—Ç–∞—Ç—å –æ–¥–µ–∂–¥—É/–∞–∫—Å–µ—Å—Å—É–∞—Ä—ã")
async def command_calculate_clothes(message: types.Message):
    await message.answer("–£–∫–∞–∂–∏—Ç–µ —Å—Ç–æ–∏–º–æ—Å—Ç—å —Ç–æ–≤–∞—Ä–∞ –≤ —é–∞–Ω—è—Ö", reply_markup=kb_return)
    await CalculateClothes.price.set()


@dp.message_handler(text="üéØ–û—Ç–∑—ã–≤—ã")
async def command_reviews(message: types.Message):
    await message.answer("–û—Ç–∑—ã–≤—ã")


@dp.message_handler(text="üë®‚Äçüíª–ü–æ–º–æ—â—å")
async def command_connect_with_manager(message: types.Message):
    await message.answer(f"–ö–∞–∫ –æ—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑? ü§î\n\n"

                         "<b>1.</b> –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ Poison (Dewu) üì≤\n"
                         "<b>2.</b> –ó–∞–π–¥–∏—Ç–µ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏ –≤—ã–±–µ—Ä–∏—Ç–µ —Ç–æ–≤–∞—Ä, –∫–æ—Ç–æ—Ä—ã–π –≤–∞–º –Ω—Ä–∞–≤–∏—Ç—Å—è. üõç\n"
                         "<b>3.</b> –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, –µ—Å—Ç—å –ª–∏ –Ω—É–∂–Ω—ã–π –≤–∞–º —Ä–∞–∑–º–µ—Ä —É –ø—Ä–æ–¥–∞–≤—Ü–∞ –∏ –ø–æ—Å–º–æ—Ç—Ä–∏—Ç–µ —Ü–µ–Ω—É (—Å–º. —Å–∫—Ä–∏–Ω—à–æ—Ç 1) üòé\n"
                         "<b>4.</b> –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –±–æ—Ç–∞ @Poison_sellBot –∏ –Ω–∞—á–Ω–∏—Ç–µ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞. –î–ª—è —ç—Ç–æ–≥–æ –≤ –≥–ª–∞–≤–Ω–æ–º –º–µ–Ω—é –Ω–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–Ω–æ–ø–∫—É \n'üöö–ó–∞–∫–∞–∑–∞—Ç—å' (—Å–º. —Å–∫—Ä–∏–Ω—à–æ—Ç 2.1) üí¨\n"
                         "<b>5.</b> –í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –≤–∞—à–µ–≥–æ —Ç–æ–≤–∞—Ä–∞ —Å –ø–æ–º–æ—â—å—é –∏–Ω–ª–∞–π–Ω –∫–Ω–æ–ø–æ–∫ (—Å–º. —Å–∫—Ä–∏–Ω—à–æ—Ç 2.2) ü§ñ\n"
                         "<b>6.</b> –£–∫–∞–∂–∏—Ç–µ —Ü–µ–Ω—É –Ω–∞ —Ç–æ–≤–∞—Ä –≤ —é–∞–Ω—è—Ö, —É–∫–∞–∑–∞–Ω–Ω—É—é –≤ –ø—É–Ω–∫—Ç–µ 3 üí∞\n"
                         "<b>7.</b> –ü—Ä–∏–¥—É–º–∞–π—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –≤–∞—à–µ–≥–æ –∑–∞–∫–∞–∑–∞, –∫–æ—Ç–æ—Ä–æ–µ –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞, —Ä–∞–∑–º–µ—Ä –∏ —Ü–≤–µ—Ç üìù\n"
                         "<b>8.</b> –£–∫–∞–∂–∏—Ç–µ —Å—Å—ã–ª–∫—É –Ω–∞ —Ç–æ–≤–∞—Ä –∏–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è Poison (Dewu) (—Å–º. —Å–∫—Ä–∏–Ω—à–æ—Ç—ã 3 –∏ 4) üîó\n"
                         "<b>9.</b> –ü—Ä–∏—à–ª–∏—Ç–µ —Å–∫—Ä–∏–Ω—à–æ—Ç, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –±—É–¥–µ—Ç –≤–∏–¥–Ω–æ —Ä–∞–∑–º–µ—Ä, —Ü–≤–µ—Ç –∏ —Ü–µ–Ω—É –≤–∞—à–µ–≥–æ —Ç–æ–≤–∞—Ä–∞ (—Å–º. —Å–∫—Ä–∏–Ω—à–æ—Ç 5) üì∑\n\n"
                         "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ –æ—Ç–Ω–µ—Å–∏—Ç–µ—Å—å –∫ –∫–∞–∂–¥–æ–º—É –ø—É–Ω–∫—Ç—É –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞. –ï—Å–ª–∏ –≤—ã –≤—Å—ë —Å–¥–µ–ª–∞–ª–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ, –±–æ—Ç —É–∫–∞–∂–µ—Ç –≤–∞–º –Ω–æ–º–µ—Ä –≤–∞—à–µ–≥–æ –∑–∞–∫–∞–∑–∞ –∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç –µ–≥–æ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞–º –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É. üôå\n\n"

                         "–ï—Å–ª–∏ —É –≤–∞—Å –≤–æ–∑–Ω–∏–∫–Ω—É—Ç –∫–∞–∫–∏–µ-–ª–∏–±–æ –≤–æ–ø—Ä–æ—Å—ã, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–æ—Å–ø–æ–ª—å–∑—É–π—Ç–µ—Å—å –∫–Ω–æ–ø–∫–æ–π 'üë®‚Äçüíª–ü–æ–º–æ—â—å'. –ú—ã –≤—Å–µ–≥–¥–∞ –≥–æ—Ç–æ–≤—ã –ø–æ–º–æ—á—å –≤–∞–º —Å –≤—ã–±–æ—Ä–æ–º —Ç–æ–≤–∞—Ä–∞ –∏ –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –ª—é–±—ã–µ –≤–æ–ø—Ä–æ—Å—ã. –°–ø–∞—Å–∏–±–æ, —á—Ç–æ –≤—ã–±—Ä–∞–ª–∏ –Ω–∞—à —Å–µ—Ä–≤–∏—Å ü§ó"
                         "‚ùî–ú–µ–Ω–µ–¥–∂–µ—Ä/–¢–µ—Ö.–ü–æ–¥–¥–µ—Ä–∂–∫–∞ ‚Äî  @poison_sell_manager")

    album = MediaGroup()
    photo_bytes = InputFile(path_or_bytesio="media/Photo1.jpg")
    album.attach_photo(photo=photo_bytes)
    photo_bytes = InputFile(path_or_bytesio="media/Photo2.1.jpg")
    album.attach_photo(photo=photo_bytes)
    photo_bytes = InputFile(path_or_bytesio="media/Photo2.2.jpg")
    album.attach_photo(photo=photo_bytes)
    photo_bytes = InputFile(path_or_bytesio="media/Photo3.jpg")
    album.attach_photo(photo=photo_bytes)
    photo_bytes = InputFile(path_or_bytesio="media/Photo4.jpg")
    album.attach_photo(photo=photo_bytes)
    photo_bytes = InputFile(path_or_bytesio="media/Photo5.jpg")
    album.attach_photo(photo=photo_bytes)
    await message.answer_media_group(album)


@dp.message_handler(text="üöö–ó–∞–∫–∞–∑–∞—Ç—å")
async def show_inline_menu_to_choose_order_type(message: types.Message):
    await message.answer("–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é —Ç–æ–≤–∞—Ä–∞:", reply_markup=ikb_menu)


@dp.callback_query_handler(text="–û–±—É–≤—å")
async def select_type_of_order_shoes(callback_query: CallbackQuery):
    await callback_query.message.answer("–£–∫–∞–∂–∏—Ç–µ —Å—Ç–æ–∏–º–æ—Å—Ç—å —Ç–æ–≤–∞—Ä–∞ –≤ —é–∞–Ω—è—Ö", reply_markup=kb_return)
    await CalculateShoes.price.set()


@dp.callback_query_handler(text="–û–¥–µ–∂–¥–∞/–∞–∫—Å–µ—Å—Å—É–∞—Ä—ã")
async def select_type_of_order_clothes(callback_query: CallbackQuery):
    await callback_query.message.answer("–£–∫–∞–∂–∏—Ç–µ —Å—Ç–æ–∏–º–æ—Å—Ç—å —Ç–æ–≤–∞—Ä–∞ –≤ —é–∞–Ω—è—Ö", reply_markup=kb_return)
    await CalculateClothes.price.set()


@dp.message_handler(text="üìã–ú–æ–∏ –∑–∞–∫–∞–∑—ã")
async def command_faq(message: types.Message):
    list_of_dicts = ORDERS.get_all_records()
    list_of_orders = []
    for slovar in list_of_dicts:
        if str(slovar["user_id"]) == str(message.from_user.id):
            list_of_orders.append([slovar["order_number"],
                                   slovar["order_name"],
                                   slovar["status"],
                                   slovar["price"],
                                   slovar["link"]])
    text = ""
    for order in list_of_orders:
        text += (f"#{order[0]}\n"
                 f"\t\t\t\t –ù–∞–∑–≤–∞–Ω–∏–µ:\t\t{order[1]}\n"
                 f"\t\t\t\t –°—Ç–∞—Ç—É—Å:\t\t{order[2]}\n"
                 f"\t\t\t\t –°—Ç–æ–∏–º–æ—Å—Ç—å:\t\t{order[3]} —Ä—É–±\n\n"
                 f"\t\t\t\t –°—Å—ã–ª–∫–∞: \t\t{order[4]}")
    await message.answer(text)


@dp.message_handler(text="–ù–∞–∑–∞–¥ ‚Ü©Ô∏è")
async def command_back(message: types.Message):
    await menu(message)
